üëã Introduction ===
+
==== Estimated time to complete: _15 minutes_<p>
+
Welcome to the third challenge.
For this challenge we will create dynamic documentation through automation.
More specifically, we will generate a HTML website using the structured data that we showcased in the previous challenge.

Login to Ansible Automation Platform with the following credentials

[cols=2*]
|===
| username:
| `admin`

| password:
| `ansible123!`
|===

= ‚òëÔ∏è Task 1 - Create a new Job Template

Click the *Templates* link in the left navigation menu underneath *Automation Execution \-> Templates* image:https://github.com/HichamMourad/awsinfravis25/blob/master/images/menu_templates.png?raw=true[templates link picture]

* Now click on `+ Create Template` then scroll down and click  `Create job template` image:https://github.com/HichamMourad/awsinfravis25/blob/master/images/create_templates.png?raw=true[,600]

Fill out the following fields:+++<table>++++++<tr>++++++<th>+++Parameter+++</th>++++++<th>+++Value+++</th>++++++</tr>+++
+++<tr>++++++<td>+++Name+++</td>++++++<td>+++Create Cloud Report+++</td>+++
+++<tr>++++++<td>+++Job Type+++</td>++++++<td>+++Run+++</td>+++
+++<tr>++++++<td>+++Inventory+++</td>++++++<td>+++Demo Inventory+++</td>+++
+++<tr>++++++<td>+++Project+++</td>++++++<td>+++AWS Demos Project+++</td>+++
+++<tr>++++++<td>+++Execution Environment+++</td>++++++<td>+++AWS Execution Environment+++</td>+++
+++<tr>++++++<td>+++Playbook+++</td>++++++<td>++++++<code>+++playbooks/cloud_report.yml+++</code>++++++</td>+++
+++<tr>++++++<td>+++Credentials+++</td>++++++<td>++++++<code>+++AWS_Credential+++</code>+++   AND   +++<code>+++SSH Controller Credential+++</code>++++++</td>+++
</table>

**Please NOTE, that this job template requires TWO credentials.  One to retrieve information from AWS, and the second to SSH to the report server and generate the cloud report**

* If you have trouble finding the `AWS_Credential` make sure you are looking under the Credential Type `Amazon Web Services`

Click the blue **Create Job Template** button.

The project we are loading Ansible Playbooks from can be found here [https://github.com/ansible-cloud/aws_demos](https://github.com/ansible-cloud/aws_demos)

‚òëÔ∏è Task 2 - Add a survey
===

For this next step we are going to add a survey so the user can select where they want the HTML report hosted.  This allows the operator to select a Linux host to serve the HTML file for others to view!

Click the **Templates** link in the left navigation menu underneath **Automation Execution**.  You will see your `Create Cloud Report` job template.
* Click the `Create Cloud Report` link to open the job template.
* Now, click the `Survey` tab at the top of the job template.

+++<img src="https://github.com/IPvSean/pictures_for_github/blob/master/survey_tab.png?raw=true" style="width:400px;margin-left:0px">++++++</img>+++

* Click the blue `Create survey question` button.

Fill out the following table:
+++<table>++++++<tr>++++++<th>+++Parameter+++</th>++++++<th>+++Value+++</th>++++++</tr>+++
+++<tr>++++++<td>+++Name+++</td>++++++<td>+++Which server do you want to host the report?+++</td>+++
	+++<tr>++++++<td>+++Answer variable name+++</td>++++++<td>++++++<code>+++_hosts+++</code>++++++</td>+++
+++<tr>++++++<td>+++Answer type+++</td>++++++<td>+++Text+++</td>+++
	+++<tr>++++++<td>+++Default answer+++</td>++++++<td>++++++<code>+++ansible-1+++</code>++++++</td>+++
</table>

Click the blue  **Create survey question** to **Save** the Survey.

Make sure to click the toggle button to enabled the survey.
+++<img src="https://github.com/HichamMourad/awsinfravis25/blob/master/images/survey_toggle_short.png?raw=true" style="width:600px;margin-left:0px">++++++</img>+++

For lab purposes we are just going to host it on the host **+++<code>+++ansible-1+++</code>+++** but we are showing how this can be easily configurable by the administrator to allow you to choose anywhere to host dynamic documentaition.  For example we can use Amazon S3 and host it there.

‚òëÔ∏è Task 3 - Launch the Job Template
===

Click the **Templates** link in the left navigation menu underneath **Automation Execution**.  You will see your `Create Cloud Report` job template.

Click the rocket symbol to `Launch Template`.
+++<img src="https://github.com/IPvSean/pictures_for_github/blob/master/launch_job.png?raw=true" style="width: 30px;margin-left:0px">++++++</img>+++

Select the host:  **`ansible-1`**

Click **Next** and then **Finish** to launch the job template.

## Explanation:
##
This playbook has two roles.

1. The first role will retrieve structured data for VPCs, EC2 instances and IGWs as shown in the previous challenge.  A link to the source code can be [found here](https://github.com/ansible-cloud/aws_demos/tree/master/roles/retrieve_info)

2. The 2nd role will create an HTML report.  This will install a web server, copy over CSS and images, and template out the structured data into an HTML website.  A link to the source code can be [found here](https://github.com/ansible-cloud/aws_demos/tree/master/roles/build_report).

When the job completes click the `Dynamic Report` tab at the top of your lab window.  The report will be generated.

**Make sure to refresh the window using the** +++<font size="14px">+++‚ü≥+++</font>+++

Click on the gray boxes with the caret `>` to expand the tables with additional information.

You will see a report similar to the following:
![picture of report](https://github.com/IPvSean/pictures_for_github/blob/master/cloud_report.png?raw=true)


‚òëÔ∏è Task 4 - Compare Regions
===

A cloud operator can quickly see how many instances are online in that region, and what VPCs they are on, as well as the associated IGW.  This is combining several info modules which correspond to multiple AWS boto3 API calls.  In the cloud report we can quickly gain awareness of the cloud footprint.

Important considerations for a cloud operator:

- How can I identify VPCs in Amazon EC2 that are not in use and can be safely deleted to free up resources for my team to provision additional VPCs?
- Which regions are running instances versus which ones that are empty?
- Which regions have stopped instances that may turn on at any moment?


‚úÖ Finished!
===
Press the `Check` button below to check your work.

üêõ Encountered an issue?
====

If you have encountered an issue or have noticed something not quite right, please [open an issue](https://github.com/ansible/instruqt/issues/new?title=Issue+with+Ansible+Hybrid+Cloud+Automation+-+Infrastructure+visibility+(aap2.5)&assignees=hichammourad).+++</tr>++++++</tr>++++++</tr>++++++</tr>++++++</table>++++++</tr>++++++</tr>++++++</tr>++++++</tr>++++++</tr>++++++</tr>++++++</tr>++++++</table>+++
